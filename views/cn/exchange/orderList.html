<!--登录用户才可以进入的订单列表页面-->
<div id="app-orderList">
    <div class="exx-title" v-if="loginUser.isBusinesUser == 1" v-cloak="">
        <h2><%- LANG('我收到的订单')%></h2>
    </div>

    <div class="exx-table" id="app-myReceiveOrder" v-if="loginUser.isBusinesUser == 1" v-cloak="">
        <div class="exx-table-head" v-if="ordersR">
            <ul>
                <li @click="changeStatus(2,100)" :class="{'active' : statusR == 100}"><%- LANG('所有')%></li>
                <li @click="changeStatus(2,0)" :class="{'active' : statusR == 0}"><%- LANG('等待接单')%><span class="tab-num" v-if="ordersR.receipts > 0">{{ordersR.receipts}}</span></li>
                <li @click="changeStatus(2,1)" :class="{'active' : statusR == 1}"><%- LANG('等待支付')%><span class="tab-num" v-if="ordersR.repays > 0">{{ordersR.repays}}</span></li>
                <li @click="changeStatus(2,3)" :class="{'active' : statusR == 3}"><%- LANG('等待确认')%><span class="tab-num" v-if="ordersR.confirms > 0">{{ordersR.confirms}}</span></li>
                <li @click="changeStatus(2,2)" :class="{'active' : statusR == 2}"><%- LANG('已完成')%></li>
                <li @click="changeStatus(2,-1)" :class="{'active' : statusR == -1}"><%- LANG('已取消')%></li>
                <li @click="changeStatus(2,4)" :class="{'active' : statusR == 4}"><%- LANG('申诉中')%><span class="tab-num" v-if="ordersR.appealTrans > 0">{{ordersR.appealTrans}}</span></li>
            </ul>
        </div>
        <div class="exx-table-body" :class="{'loading loading-light-bg' : lockedR && !ordersR}">
            <table>
                <thead>
                <tr>
                    <th><%- LANG('订单号')%></th>
                    <th><%- LANG('创建时间')%></th>
                    <th><%- LANG('类型')%></th>
                    <th><%- LANG('交易对象')%></th>
                    <th><%- LANG('价格')%>({{moneyName}})</th>
                    <th><%- LANG('数量')%>({{coinName}})</th>
                    <th><%- LANG('金额')%>({{moneyName}})</th>
                    <th><%- LANG('状态')%></th>
                    <th><%- LANG('操作')%></th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="order in ordersR.order" v-if="ordersR">
                    <td>{{order.id}}</td>
                    <td>{{getTime(order.createTime)}}</td>
                    <td>{{order.ad.type == 1 ? "<%- LANG('买入')%>" : "<%- LANG('卖出')%>"}}</td>
                    <td><a @click="gotoOtherInfo(order.user.id)" class="userinfo">{{order.user.name}}</a></td>
                    <td>{{order.price}}</td>
                    <td>{{order.ad.type == 1 ? '+' : '-'}}{{order.amount}}</td>
                    <td>{{order.ad.type == 1 ? '-' : '+'}}{{order.money}}</td>
                    <td>
                        <template v-if="order.status == 1 && order.ad.type == 1"><%- LANG('请给对方打款并确认')%></template>
                        <template v-else-if="order.status == 3 && order.ad.type == 1"><%- LANG('等待对方确认收款')%></template>
                        <template v-else-if="order.status == 1 && order.ad.type == 2"><%- LANG('等待对方打款并确认')%></template>
                        <template v-else-if="order.status == 3 && order.ad.type == 2"><%- LANG('对方已打款，请确认')%></template>
                        <template v-else="">{{statusObj[order.status]}}</template>
                    </td>
                    <td>
                        <a v-if="order.status == 0" @click="doOrder(2, order.id, 1)" role="button"><%- LANG('接单')%></a>
                        <a v-if="order.status == 0" @click="doOrder(2, order.id, 8)" role="button"><%- LANG('拒绝')%></a>
                        <a :href="'/exchange/orderInfo?id=' + order.id" role="button" target="_self"><%- LANG('详细')%></a>
                    </td>
                </tr>
                <tr v-if="ordersR && ordersR.order.length == 0">
                    <td colspan="9">
                        <p class="norecord"><%- LANG('暂无记录') %></p>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <page-lite page-name="pageIndexR" :page-index="pageIndexR" :page-size="pageSize" :page-count="pageCountR" @turn-page="getOrderListR" v-if="ordersR && ordersR.order.length > 0 || pageIndexR > 1"></page-lite>
    </div>


    <div class="exx-title" v-cloak="">
        <h2><%- LANG('我发起的订单') %></h2>
    </div>

    <div class="exx-table" id="app-mySendOrder" v-cloak="">
        <div class="exx-table-head" v-if="ordersS">
            <ul>
                <li @click="changeStatus(1,100)" :class="{'active' : statusS == 100}"><%- LANG('所有') %></li>
                <li @click="changeStatus(1,0)" :class="{'active' : statusS == 0}"><%- LANG('等待接单') %><span class="tab-num" v-if="ordersS.receipts > 0">{{ordersS.receipts}}</span></li>
                <li @click="changeStatus(1,1)" :class="{'active' : statusS == 1}"><%- LANG('等待支付') %><span class="tab-num" v-if="ordersS.repays > 0">{{ordersS.repays}}</span></li>
                <li @click="changeStatus(1,3)" :class="{'active' : statusS == 3}"><%- LANG('等待确认') %><span class="tab-num" v-if="ordersS.confirms > 0">{{ordersS.confirms}}</span></li>
                <li @click="changeStatus(1,2)" :class="{'active' : statusS == 2}"><%- LANG('已完成') %></li>
                <li @click="changeStatus(1,-1)" :class="{'active' : statusS == -1}"><%- LANG('已取消') %></li>
                <li @click="changeStatus(1,4)" :class="{'active' : statusS == 4}"><%- LANG('申诉中') %><span class="tab-num" v-if="ordersS.appealTrans > 0">{{ordersS.appealTrans}}</span></li>
            </ul>
        </div>
        <div class="exx-table-body" :class="{'loading loading-light-bg' : lockedS && !ordersS}">
            <table>
                <thead>
                <tr>
                    <th><%- LANG('订单号') %></th>
                    <th><%- LANG('创建时间') %></th>
                    <th><%- LANG('类型') %></th>
                    <th><%- LANG('交易对象') %></th>
                    <th><%- LANG('价格') %>({{moneyName}})</th>
                    <th><%- LANG('数量') %>({{coinName}})</th>
                    <th><%- LANG('金额') %>({{moneyName}})</th>
                    <th><%- LANG('状态') %></th>
                    <th><%- LANG('操作') %></th>
                </tr>
                </thead>
                <tbody>
                <tr v-for="order in ordersS.order" v-if="ordersS">
                    <td>{{order.id}}</td>
                    <td>{{getTime(order.createTime)}}</td>
                    <td>{{order.ad.type == 2 ? "<%- LANG('买入')%>" : "<%- LANG('卖出')%>"}}</td>
                    <td><a @click="gotoOtherInfo(order.ad.user.id)" class="userinfo">{{order.ad.user.name}}</a></td>
                    <td>{{order.price}}</td>
                    <td>{{order.ad.type == 1 ? '-' : '+'}}{{order.amount}}</td>
                    <td>{{order.ad.type == 1 ? '+' : '-'}}{{order.money}}</td>
                    <td>
                        <template v-if="order.status == 1 && order.ad.type == 2"><%- LANG('请给对方打款并确认')%></template>
                        <template v-else-if="order.status == 3 && order.ad.type == 2"><%- LANG('等待对方确认收款')%></template>
                        <template v-else-if="order.status == 1 && order.ad.type == 1"><%- LANG('等待对方打款并确认')%></template>
                        <template v-else-if="order.status == 3 && order.ad.type == 1"><%- LANG('对方已打款，请确认')%></template>
                        <template v-else="">{{statusObj[order.status]}}</template>
                    </td>
                    <td>
                        <!--<a v-if="order.status == 0" @click="doOrder(1, order.id, 7)" role="button">取消</a>-->
                        <a :href="'/exchange/orderInfo?id=' + order.id" role="button" target="_self"><%- LANG('详细')%></a>
                    </td>
                </tr>
                <tr v-if="ordersS && ordersS.order.length == 0">
                    <td colspan="9">
                        <p class="norecord"><%- LANG('暂无记录') %></p>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
        <page-lite page-name="pageIndexS" :page-index="pageIndexS" :page-size="pageSize" :page-count="pageCountS" @turn-page="getOrderListS" v-if="ordersS && ordersS.order.length > 0 || pageIndexS > 1"></page-lite>
    </div>
</div>
<%-include("../component/page_lite.html")%>
<%-include("app.orderList.html")%>