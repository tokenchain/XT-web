<style>
    #header_menu_he .main-nav .dropdown .arrow {
        color: #4FD3D3;
    }

    #rolling {
        height: 25px;
        line-height: 25px;
        overflow: hidden;
    }

    .headNav {
        color: #fff !important;
    }

    .right-A a {
        color: #fff;
    }

    .right-A a:hover {
        color: #5a7ff5;
    }

    .headNav:hover a {
        color: #fff !important
    }

    #header-navigator .active {
        color: rgba(255, 190, 63, 1);
        font-size: 16px;
    }

    @media (max-width: 768px) {
        .headNav {

        }
    }

</style>
<header class="header" onclick="closeMenu();" id="header_menu_he">
    <a href="/" class="logo">
        <img src="<%= IMG_STATIC %>/images/logo.png"/>
    </a>
    <div class="header-nav" id="header-navigator">
        <ul class="main-nav">
            <li>
                <a role="button" href="/trade/btc_usdt" id="menu_exchange" :class="{active: activeNav=='trade'}">
                    <%= LANG('币币交易') %>
                </a>
            </li>
            <li id="otcList"><a role="button" href="/otcTrade" :class="{active:activeNav=='otcTrade'}"><%= LANG('OTC交易')
                %></a></li>
            <li><a role="button" href="/appstore" :class="{active:activeNav=='appstore'}">App</a></li>

            <!--<li><a role="button" href="/appstore" >App</a></li>-->
            <!-- <li><a role="button" href="/market" id="menu_market"><%= LANG('市场') %></a></li> -->
            <!-- <li class="dropdown" onclick="showLoginList('ztmenu_list',0,event)">
                <p role="button" class="arrow">
                    <%= LANG('挖矿专区') %>
                </p>
                <ul class="dropdown-menu" id="ztmenu_list">
                    <li>
                        <a href="/zt" id="menu_summary">
                            <%= LANG('概况') %>
                        </a>
                    </li>
                    <li><a href="/zb_zt" id="menu_zbzt">ZB换码ZT</a></li>
                    <li>
                        <a href="/ztfee" id="menu_porfet">
                            <%= LANG('网站利润') %>
                        </a>
                    </li>
                    <li>
                        <a href="/ztminer" id="menu_exchangeMiner">
                            <%= LANG('交易挖矿') %>
                        </a>
                    </li>
                    <li>
                        <a href="/king">
                            <%= LANG('富豪&逆袭') %>
                        </a>
                    </li>

                </ul>
            </li> -->
        </ul>
        <div class="notice-nav" style="visibility: hidden">
            <a href="https://xt.zendesk.com/hc/zh-cn" target="_blank" class="title"
               style="border-right: 1px solid rgba(255,255,255,30%);">
                <%= LANG('公告') %>
            </a>
            <div id="rolling">
                <ul>
                </ul>
            </div>
        </div>
        <!-- <div class="headNav" style="margin-left: 38px">
                <a href="/appstore"  style="color:#fff"><%= LANG('ZT分红') %></a>
        </div>
        <div class="headNav" style="margin-left: 38px">
                <a href="/newmarket" style="color:#fff"><%= LANG('上币排行') %></a>
        </div>
        <div class="headNav" style="margin-left: 38px">
                <a href="/appstore" style="color:#FFF"><%= LANG('下载APP') %></a>
        </div> -->
        <ul class="user-nav" id="user-nav">
            <!--<li class="headNav" :class="{active:activeNav=='ztminer'}">
                    <a href="/zt"   ><%= LANG('ZT') %></a>
            </li>
            <li class="headNav" :class="{active:activeNav=='newmarket'}">
                    <a href="/newmarket"  ><%= LANG('上币排行') %></a>
            </li>-->
            <li id="zichanguanli" class="right-A">
                <a href="/u/asset" id="menu_asset">
                    <%= LANG('资产管理') %>
                </a>
            </li>


            <li class="dropdown" id="menu_loginedList" style="display: none;"
                onclick="showLoginList('dropdown_menuLogin',2,event)">
                <p role="button" class="arrow" data-toggle="dropdown">
                    <img src="<%= IMG_STATIC %>/images/icon/user-icon.png"/>
                    <span id="menuUsername">-</span>
                </p>
                <ul class="dropdown-menu" id="dropdown_menuLogin">
                    <!--<li v-if="userInfo.userType == 1" v-cloak><a style="padding-left: 20px;" role="button" href="/u/recommend"><%= LANG('推荐分享') %></a></li>-->
                    <li>
                        <a href="/u" id="user_center">
                            <%= LANG('用户中心') %>
                        </a>
                    </li>
                    <!--<li>
                        <a href="/u/asset" id="menu_asset">
                            <%= LANG('资产管理') %>
                        </a>
                    </li>-->
                    <li>
                        <a role="button" href="/u/api" id="menu_api">
                            <%= LANG('API设置') %>
                        </a>
                    </li>
                    <li>
                        <a role="button" href="javascript:;" onclick="Methods.logout()" id="menu_loginout">
                            <%= LANG('退出登录') %>
                        </a>
                    </li>
                </ul>
            </li>
            <li class="dropdown" onclick="showLoginList('dropdown_menuLanguage',1,event)">
                <p role="button" class="arrow" data-toggle="dropdown">
                    <img src="<%= IMG_STATIC %>/images/icon/language-icon.png"/>
                    <span id="menuLanguage">简体中文</span>
                </p>
                <ul class="dropdown-menu" id="dropdown_menuLanguage">
                    <li class="cn">
                        <a onclick="SetLan('cn')">简体中文 </a>
                    </li>
                    <li class="en">
                        <a onclick="SetLan('en')">English</a>
                    </li>
                </ul>
            </li>
            <li class="signup" id="menu_signInLi">
                <a role="button" href="/login" id="menu_signin">
                    <%= LANG('登录') %>
                </a>
            </li>
            <li id="menu_signUpLi">
                <a role="button" href="/register" role="button" id="menu_signup">
                    <%= LANG('注册') %>
                </a>
            </li>
        </ul>

    </div>
    <modal :open="showModal == 'transfer'" @close="showModal = false">
        <transfer :info="transferInfo"/>
    </modal>

    <modal :open="showModal == 'payin'" @close="showModal = false">
        <modal-payin :coin="payinCoin"/>
    </modal>
    <div class="header-button" id="header_mobel_button" onclick="SwitchClass(this)">
        <span></span>
    </div>
</header>
<script type="application/javascript">
    var switchClosed = false;

    function hasClass(ele, cls) {
        return ele.className.match(new RegExp('(\\s|^)' + cls + '(\\s|$)'));
    }

    function addClass(ele, cls) {
        if (!this.hasClass(ele, cls)) ele.className += " " + cls;
    }

    function removeClass(ele, cls) {
        if (hasClass(ele, cls)) {
            var reg = new RegExp('(\\s|^)' + cls + '(\\s|$)');
            ele.className = ele.className.replace(reg, ' ');
        }
    }

    function SwitchClass(t) {
        if (switchClosed) {
            switchClosed = false;
            removeClass(t, "close-button");
            removeClass(document.getElementById("header_menu_he"), "open")
        } else {
            switchClosed = true;
            addClass(t, "close-button");
            addClass(document.getElementById("header_menu_he"), "open");

        }
    }

    var language = ["简体中文", "English"];
    var menuLangeage_cn = ["登录", "注册", "币币交易", "市场", "ZT", "用户中心", "资产管理", "API设置", "退出登录", "概况", "ZB换码ZT", "网站收益",
        "挖矿专区"
    ];
    var menuLangeage_en = ["SignIn", "SignUp", "Exchange", "Market", "ZT", "UserCenter", "AssetManage", "API Setting",
        "SignOut", "Summary", "Change ZB to ZT", "Profit", "Trans-fee Mining", "Referee"
    ];
    var languageArray = [menuLangeage_cn, menuLangeage_en];


    function setCookie(name, value) {

        var exp = new Date();
        exp.setTime(exp.getTime() + 12 * 60 * 60 * 1000); //12小时
        window.document.cookie = name + "=" + value + ";path=/;expires=" + exp.toGMTString();
    }

    //读取cookies
    function getCookie(name) {
        var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");

        if (arr = document.cookie.match(reg))

            return unescape(arr[2]);
        else
            return null;
    }

    function delCookie(name) {
        var exp = new Date();
        exp.setTime(exp.getTime() - 1);
        var cval = getCookie(name);
        if (cval != null)
            document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString();
    }

    var isLogin = function () {
        return (getCookie("zuname") != null && getCookie("zuname") != "none") || (getCookie("wuname") != null &&
            getCookie("wuname") != "none");
    };
    var lanIndex = 0;
    var langCookie = getCookie("wlan");
    if (langCookie == null || langCookie == "none")
        langCookie = getCookie("zlan");
    if (langCookie == null || langCookie == "none") {

        var lang = (navigator.systemLanguage ? navigator.systemLanguage : navigator.language);
        //获取浏览器配置语言 #括号内是个运算，运算过后赋值给lang，当?前的内容为true时把?后的值赋给lang，为False时把:后的值赋给lang
        var lang = lang.substr(0, 2); //获取lang字符串的前两位
        if (lang == 'zh') {
            lanIndex = 0;

            setCookie("wlan", "cn");
            setCookie("zlan", "cn");
        } else {
            lanIndex = 1;
            setCookie("wlan", "en");
            setCookie("zlan", "en");
        }
        ;
        document.getElementById("menuLanguage").innerHTML = language[lanIndex];
    }

    if (langCookie != null && langCookie != "none") {

        if (langCookie == "cn")
            lanIndex = 0;
        else if (langCookie == "en")
            lanIndex = 1;
        document.getElementById("menuLanguage").innerHTML = language[lanIndex];
    }
    if (isLogin()) {
        var username = getCookie("wuname");

        if (username == null || username == "none")
            username = getCookie("zuname");

        var length = username.length;
        if (length <= 6) {
            var newName = username.substring(0, 3) + "***";
            document.getElementById("menuUsername").innerHTML = username;
        } else {
            var newName = username.substring(0, 3) + "***" + username.substring(length - 3, length);
            document.getElementById("menuUsername").innerHTML = username;
        }


        document.getElementById("zichanguanli").style.display = "flex";
        // document.getElementById("otcList").style.display = "flex";
        document.getElementById("menu_loginedList").style.display = "flex";
        document.getElementById("menu_signUpLi").style.display = "none";
        document.getElementById("menu_signInLi").style.display = "none";
    } else {
        document.getElementById("zichanguanli").style.display = "none";
        // document.getElementById("otcList").style.display = "none";
        document.getElementById("menu_loginedList").style.display = "none";
        document.getElementById("menu_signUpLi").style.display = "flex";
        document.getElementById("menu_signInLi").style.display = "flex";
    }

    // document.getElementById("user_center").innerHTML = languageArray[lanIndex][5];
    // document.getElementById("menu_asset").innerHTML = languageArray[lanIndex][6];
    // document.getElementById("menu_api").innerHTML = languageArray[lanIndex][7];
    // document.getElementById("menu_loginout").innerHTML = languageArray[lanIndex][8];

    // document.getElementById("menu_signin").innerHTML = languageArray[lanIndex][0];
    // document.getElementById("menu_signup").innerHTML = languageArray[lanIndex][1];
    // document.getElementById("menu_exchange").innerHTML = languageArray[lanIndex][2];
    // document.getElementById("menu_market").innerHTML = languageArray[lanIndex][3];

    // document.getElementById("menu_summary").innerHTML = languageArray[lanIndex][9];
    // document.getElementById("menu_zbzt").innerHTML = languageArray[lanIndex][10];
    // document.getElementById("menu_porfet").innerHTML = languageArray[lanIndex][11];
    // document.getElementById("menu_exchangeMiner").innerHTML = languageArray[lanIndex][12];
    // document.getElementById("menu_refe").innerHTML = languageArray[lanIndex][13];

    function DoSign_out(lan) {

        var cookies = document.cookie.split(";");
        for (var i = 0; i < cookies.length; i++) {
            var cookie = cookies[i];
            var eqPos = cookie.indexOf("=");
            var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
            document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/";
        }
        if (cookies.length > 0) {
            for (var i = 0; i < cookies.length; i++) {
                var cookie = cookies[i];
                var eqPos = cookie.indexOf("=");
                var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
                document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; domain=." + DOMAIN_BASE;
            }
        }
        location.replace(location.href);
    }

    function SetLan(lan) {
        console.log(1)
        var name = 'wlan';
        var name2 = 'zlan';

        setCookie(name, lan);
        setCookie(name2, lan);

        location.replace(location.href);
    }

    function addListener(element, e, fn) {
        element.addEventListener ? element.addEventListener(e, fn, false) : element.attachEvent("on" + e, fn)
    }

    function removeListener(element, e, fn) {
        element.removeEventListener ? element.removeEventListener(e, fn, false) : element.detachEvent("on" + e, fn)
    }

    var menuArr = [false, false, false];

    function closeMenu() {
        if (menuArr[0]) {
            menuArr[0] = false;
            document.getElementById("ztmenu_list").style.display = "none";
        }
        if (menuArr[1]) {
            menuArr[1] = false;
            document.getElementById("dropdown_menuLanguage").style.display = "none";
        }
        if (menuArr[2]) {
            menuArr[2] = false;
            document.getElementById("dropdown_menuLogin").style.display = "none";
        }
    }

    function showLoginList(ids, index, event) {
        console.log(menuArr)
        if (menuArr[index]) {
            document.getElementById(ids).style.display = "none";
            menuArr[index] = false;
        } else {
            closeMenu();
            menuArr[index] = true;
            document.getElementById(ids).style.display = "block";
        }
        event.stopPropagation();
    }
</script>
<script src="https://cdn.bootcss.com/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript">
    function AutoScroll(obj) {
        $(obj).find("ul:first").animate({
            marginTop: "-25px"
        }, 500, function () {
            $(this).css({
                marginTop: "0px"
            }).find("li:first").appendTo(this);
        });
    }

    $(document).ready(function () {
        require(['common/methods', 'vue', 'validate'], function (Methods, Vue) {
            new Vue({
                el: '#header-navigator',
                data: function () {
                    return {
                        activeNav: ''
                    }
                },
                mounted: function () {
                    //监听滚动事件
                    /*$(window).scroll(function(event){
                        var winPos = $(window).scrollTop();
                        if (winPos > 60) {
                            $('#header_menu_he').addClass('active')
                        } else if (winPos < 60) {
                            $('#header_menu_he').removeClass('active')
                        }
                    })*/
                    $(window).click(function (e) {
                        e.stopPropagation()
                        $('#dropdown_menuLogin').hide()
                    })
                },
                created() {
                    var href = window.location.href
                    var arr = ['trade', 'otcTrade', 'newmarket', 'appstore']
                    var _this = this
                    arr.forEach(function (val) {
                        if (href.indexOf(val) != -1) {
                            _this.activeNav = val
                        }
                    })
                    //jquery.validator验证配置
                    if ('<%= LAN %>' == 'cn') {
                        $.validator.addMethod("NumThanZero", function (value, element) {
                            return this.optional(element) || /^([1-9]\d*(\.\d*[1-9])?)|(0\.\d*[1-9])$/.test(value);
                        }, "请输入大于0的数字")
                        $.validator.addMethod("than", function (value, element, param) {
                            return this.optional(element) || parseFloat(value) >= parseFloat(param);
                        }, $.validator.format("请输入大于 {0} 的数字"))
                        $.validator.addMethod("lessThan", function (value, element, param) {
                            return this.optional(element) || parseFloat(value) <= parseFloat(param);
                        }, $.validator.format("请输入小于 {0} 的数字"))
                        $.extend($.validator.messages, {
                            required: "这是必填项",
                            remote: "请修正此项",
                            email: "请输入有效的电子邮件地址",
                            url: "请输入有效的网址",
                            date: "请输入有效的日期",
                            dateISO: "请输入有效的日期 (YYYY-MM-DD)",
                            number: "请输入有效的数字",
                            digits: "只能输入数字",
                            creditcard: "请输入有效的信用卡号码",
                            equalTo: "你的输入不相同",
                            extension: "请输入有效的后缀",
                            maxlength: $.validator.format("最多可以输入 {0} 个字符"),
                            minlength: $.validator.format("最少要输入 {0} 个字符"),
                            rangelength: $.validator.format("请输入长度在 {0} 到 {1} 之间的字符串"),
                            range: $.validator.format("请输入范围在 {0} 到 {1} 之间的数值"),
                            step: $.validator.format("请输入 {0} 的整数倍值"),
                            max: $.validator.format("请输入不大于 {0} 的数值"),
                            min: $.validator.format("请输入不小于 {0} 的数值")
                        });
                    }
                },
                methods: {
                    logout: function () {
                        Methods.logout()
                    }
                }
            })
        })
    });
</script>