<style>
    #realName {
        padding: 70px 260px;
    }
    .step {
        text-align: center;
        margin-bottom: 30px;
        padding-left: 100px;
    }
    #realName .form-group {
        display: flex;
        margin-bottom: 30px;
    }
    #realName .form-group .form-control {
        flex: 1;
    }
    #realName .form-group .control-label {
        width: 20%;
        line-height: 45px;
        color: #898989;
        text-align: right;
        margin-right: 22px;
    }
    #realName input {
        width: 400px;
        height: 45px;
        line-height: 45px;
        border-radius: 8px;
        padding-left: 10px;
        border: 1px solid #DBDBDB;
        color: #666;
    }
    #realName .form-button {
        margin-top: 58px;
    }
    #realName .form-button button {
        width: 154px;
        height: 44px;
        line-height: 44px;
        padding: 0;
        border-radius: 30px;
    }
</style>
<div class="user-container realName" id="realName" v-cloak>
    <div class="step">
        <img src="/src/images/step-one.png" alt="">
    </div>
    <div class="form-Box">
        <div class="form-group" v-if="nickname == loginName">
            <label class="control-label"><%= LANG('昵称') %>：</label>
            <div class="form-control">
                <input autocomplete="off" placeholder="<%= LANG('请输入昵称') %>" v-model="nickName" type="text" maxlength="10">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label"><%= LANG('真实姓名') %>：</label>
            <div class="form-control">
                <input autocomplete="off" placeholder="<%= LANG('请输入真实姓名') %>" v-model="name" type="text">
            </div>
        </div>
        <div class="form-group">
            <label class="control-label"><%= LANG('身份证号') %>：</label>
            <div class="form-control">
                <input autocomplete="off" placeholder="<%= LANG('请输入身份证号') %>" v-model="IDcard" type="text">
            </div>
        </div>
        <div class="form-button"><button class="button" @click="submit"><span><%= LANG('提交') %></span></button></div>
    </div>
</div>

<script>
    require(['vue', 'common/methods', 'common/juabox'], function (Vue, Methods, JuaBox) {
        var recommend = new Vue({
            el: "#realName",
            data: function () {
                return {
                    nickname: '',
                    name: '',
                    IDcard: '',
                    loginUser: Methods.getLocalUserInfo(ENV + 'userInfo'), //用户信息
                    loginName: '',
                    nickName:''
                }
            },
            created() {
                this.nickname = this.loginUser.nickName,
                this.loginName = this.loginUser.loginName,
                console.log(this.loginUser)
            },
            methods: {
                submit: function () {
                    var nameReg = /^[\u0391-\uFFE5A-Za-z]+$/; // 姓名正则验证，除去数字以及特殊字符
                    var idcardReg = /(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/; // 身份证号正则
                    if(this.name == '') {
                        return JuaBox.info('<%= LANG("姓名不能为空") %>');
                    }else if(!nameReg.test(this.name)) {
                        return JuaBox.info('<%= LANG("姓名不能含有特殊字符") %>');
                    }else if(this.IDcard == '') {
                        return JuaBox.info('<%= LANG("身份证号不能为空") %>');
                    }else if(!idcardReg.test(this.IDcard)) {
                        return JuaBox.info('<%= LANG("请输入正确的身份证号") %>');
                    }
                    Methods.ajax({
                        type: 'GET',
                        url: DOMAIN_DEV + "/exchange/xt_extends/parter/controller/website/xtuseridentifycontroller/generalIdentify",
                        data: {
                            nickName: this.nickName || '',
                            Userid: this.loginUser.userId,
                            realName: this.name,
                            idNumber: this.IDcard
                        },
                        success: function (res) {
                            window.location.href= '/u/certify'
                        }.bind(this)
                    });
                }
            },
        })
    });
</script>