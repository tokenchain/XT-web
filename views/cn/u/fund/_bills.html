<div id="inc-bills" class="bk-tabList">
  <div class="pd-fff">
    <div class="bk-tabList-hd clearfix">
      <div class="btn-group bk-btn-group" role="group">
        <a class="btn" :class="{active: recordType === 'all'}" v-on:click="changeRecordType('all')"><%= LANG('所有记录') %></a>
        <a class="btn" :class="{active: recordType === 'payin'}" v-on:click="changeRecordType('payin')"><%= LANG('充值记录') %></a>
        <a class="btn" :class="{active: recordType === 'payout'}" v-on:click="changeRecordType('payout')"><%= LANG('提币记录') %></a>
        <a class="btn" :class="{active: recordType === 'trade'}" v-on:click="changeRecordType('trade')"><%= LANG('交易记录') %></a>
        <a class="btn" :class="{active: recordType === 'exchange'}" v-on:click="changeRecordType('exchange')"><%= LANG('兑换记录') %></a>
        <a class="btn" :class="{active: recordType === 'other'}" v-on:click="changeRecordType('other')"><%= LANG('其他') %></a>
      </div>
    </div>
    <div class="bk-tabList-bd table-responsive" style="min-height:400px;">
      <json-table :loading="loadingBill"  class="table-striped table-bordered" :columns="allRecordCols" :rows="allRecordRows" ></json-table>
    </div>
    <!--
    <div class="bk-tabList-fd bk-pageNav" id="billDetail_Page"><ul class="pagination"><li class="disabled"><a href="javascript:;"><i class="fa fa-angle-left"></i></a></li><li class="active"><a href="javascript:;">1</a></li><li class="tcdNumber"><a href="javascript:;">2</a></li><li class="tcdNumber"><a href="javascript:;">3</a></li><li class="nextPage"><a href="javascript:;"><i class="fa fa-angle-right"></i></a></li></ul></div>
    -->
  </div>
</div>

<%-include("../../component/json_table.html")%>
<script>
  require(['vue', 'common/methods'], function(Vue, Methods) {
    EXX.records = new Vue({
      el: "#inc-bills",
      data: function () {
        return {
          sharedState: store.state,
          loadingBill: true,
          recordType: 'all',
          allRecordCols: [
            { label: "<%= LANG('时间') %>", key: "billData", cell: function(item) {
              return Methods.getDateTime(item.billDate, 'MDT');
            }},
            { label: "<%= LANG('类别') %>", key: "typeName", cell: function(item) {
              return "<p class='text-primary'>" + item.typeName + "</p><p><%= LANG('流水号') %>" + item.id + "</p>";
            }},
            { label: "<%= LANG('发生金额') %>", key: "mainBlalance", cell: function(item) {
              return item.inout + item.mainChange + " " + item.mainCurrency + " = " + item.mainBalance + " " + item.mainCurrency;
            }}
          ],
          allRecordRows: [],
          payinCoinRecords: [],
          payoutCoinRecords: [],
          payRecordCols: [
            {  }
          ]
        }
      },
      computed: {
      },
      methods: {
        getBill: function(userId) {
          var data = {
            billType: this.recordType,
            childId: userId ? userId : this.sharedState.currentAccountId,
            pageIndex: 1,
            pageSize: 10
          };
          this.loadingBill = true;
          Methods.ajax({
            type: 'GET',
            url: DOMAIN_MAIN + API_PREFIX + 'getBill',
            data: data,
            success: function(res) {
              this.allRecordRows = res.datas.bills;
              this.loadingBill = false;
            }.bind(this)
          });
        },
        changeRecordType: function (type) {
          this.recordType = type;
          this.getBill();
        },
        getPayoutCoinRecords: function () {
          var data = {
            dataType: 0,
            coint: 'btc',
            pageIndex: 1,
            pageSize: 10
          };
          Methods.ajax({
            type: 'GET',
            url: DOMAIN_MAIN + API_PREFIX + 'getPayoutCoinRecord',
            data: data,
            success: function(res) {
              this.payoutCoinRecords = res.datas;
              console.log(res);
            }.bind(this)
          });

        },
        getPayinCoinRecord: function () {
          var data = {
            dataType: 0,
            coint: 'all',
            pageIndex: 1,
            pageSize: 10
          };
          Methods.ajax({
            type: 'GET',
            url: DOMAIN_MAIN + API_PREFIX + 'getBill',
            data: data,
            success: function(res) {
              this.payinCoinRecords = res.datas.bills;
            }.bind(this)
          });

        },
        getBillType: function() {
          Methods.ajax({
            type: 'GET',
            url: DOMAIN_MAIN + API_PREFIX + 'getBillType',
            success: function(res) {
              //console.log(res);
              //return res;
            }
          });
        }
      },
      created: function() {
        this.getBill();
      },
      mounted: function() {
      },
      watch: {
        sharedState: function() {
          this.getBill();
        }
      }
    })
  });
</script>