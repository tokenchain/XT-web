#EXX网页端API需求文档1.0


| 版本   | 时间         | 修订人  | 修订内容 | 备注 |
| :--- | :--------- | :--- | :--- | :--- |
| 1.0  | 2017-04-18 | 农达超  | 创建文档 |  |

[TOC]


##接口约定

###通讯授权协议

###请求方法说明

>- **get、post**
> 用户名、密码等部分参数进行RSA加密处理
>- **websocket**
> 行情、委托、盘口、资金等接口需配备推送方法
>- **url**
> 默认url前缀为 DOMAIN/api/web/v2_2/

###返回规范

各个接口方法统一最外层都返回resMsg ，datas 两个对象，datas视具体的方法返回值内容。

| 参数名    | 类型     | 是否必须 | 描述                          |
| ------ | ------ | ---- | --------------------------- |
| resMsg | {} | 是    | 消息对象，所有接口都会返回该对象，接口定义中不再说明。 |
| datas  | {} | 是    | 其他返回参数，所有接口返回的参数都封装到datas里面，接口定义中不再说明。 |

**resMsg 对象**

| 参数名    | 类型     | 是否必须 | 描述                          |
| ------ | ------ | ---- | --------------------------- |
| code | string | 是    | 错误代码 |
| message | string  | 是    | 错误描述 |

`错误代码参阅每个项目的systemCode.java文件`
```
{
	resMsg: {
	"code":"1000",
	"message":"SUCCESS."
	},
	datas: {
	  "userInfo": {
	    "userId":"1",
	    "userName":"test",
	    "pnumber":"18900000000",
	    "email":"myemail@163.com"
	  },
	}
}
```

**数据格式**

>- **字符串：**除了使用数字代表的状态值参数使用整型，其他全部使用字符串返回。
>- **时间戳：**时间类型的返回值全部使用时间戳返回。
>- **资产小数位：**人民币资产返回4位小数，虚拟货币资产返回8位小数。

###分页约定

接口中凡是需要分页的地方都不返回总数量和总页码数量，前台只传入以下两个参数作为分页查询依据。

| 参数名     | 类型     | 是否必须 | 示例      | 描述   |
| :------ | :----- | :--- | :------ | :--- |
| pageIndex | int | 否  | | 页码 默认1 |
| pageSize | int | 否  | | 每页数量 默认10 |

排序默认按照时间降序排列。

##一、全局通用接口

##二、用户相关接口

----------
###2.1  用户注册 

**描述**：

提供使用手机或者Email注册功能，单个手机、Email只允许注册一个账号，使用短信/邮箱验证码验证帐号有效性，邮箱注册不发送加密连接。

**请求URL**： 
> register

**请求方法**
> post

**请求参数**

| 参数名          | 类型     | 是否必须 | 描述   |
| :----------- | :----- | :--- | :--- |
| userType | int | 是    | 用户名类型 1：手机号码，2：邮箱 |
| countryCode   |  String   |   是    |  区号（手机归属地）|
| userName | String | 是    | 手机号/邮箱 |
| verificationCode   | String | 是    | 图形验证码 |
| dynamicCode     | String | 是    | 短信验证码（手机号码注册时需要）(RSA)|
| loginPwd     | String | 是    | 登录密码(RSA)|

**返回结果**

>- 注册成功后即完成登录，返回结果与getUserInfo方法一致。
>- 注册成功后设置[env]uon登录状态值为5，需要设置二级密码。

###2.2  用户登录 

**描述**：

提供使用手机号、用户名、Email登录，使用手机号登录时，如果该手机关联多个账号，则返回错误提示要求用户使用用户名或账号进行登录

**请求URL**： 
> login

**请求方法**
> post

**请求参数**

| 参数名      | 类型     | 是否必须 | 描述         |
| :------- | :----- | :--- | :--------- |
| userType | int | 是    | 用户名类型 3：用户名，1：手机号码，2：邮箱 |
| countryCode   |  String   |   是    |  区号（手机归属地） |
| userName | String | 是    | 用户名/手机号/邮箱 |
| password | String | 是    | 登录密码(RSA)       |
| imgCode| String | 否    | 失败次数过多则需要填写图形验证码 |


 **正常登录：**
 返回结果与getUserInfo方法返回结果一致

**需要填写图形验证码：**
返回1024错误，前端显示图形验证码表单，返回结果datas对象为空。

**需要二次登录：**
返回1017，1018，1020错误，返回结果与getUserInfo方法返回结果一致

**需要设置二级密码：**
返回1026错误，返回结果与getUserInfo方法返回结果一致


###2.3  发送短信/邮件验证码

**描述**

**请求URL**
> sendCode

**请求方法**
> POST

**请求参数**

| 参数名      | 类型    | 是否必须 | 描述         |
| :------- | :----- | :--- | :--------- |
| countryCode   |  String   |   是    |  区号（手机归属地） |
| mobileNumber | String | 是    | 手机号(RSA)    |
| email | String | 是    | 邮箱(RSA)    |
| graphicalCode | boolean | 否    | 图形验证码    |
| type| int | 是  | 验证码类型：1注册、2找回密码、3其他 |

**操作成功**
1、返回dynamicCode，短信验证码已发送到您的手机，10分钟内有效
2、返回dynamicCode，验证码已发送到您的邮箱xxx@xx.com，请登录邮箱查看，10分钟内有效。

**操作失败**
发送失败，请稍后重试

**请求验证码过多**
返回您今天发送的验证码已超过限制。


